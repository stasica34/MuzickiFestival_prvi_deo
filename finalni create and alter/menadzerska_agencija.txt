CREATE TABLE MENADZERSKA_AGENCIJA
(
    "ID" NUMBER,
    "NAZIV" VARCHAR2(100 BYTE),
    "ADRESA" VARCHAR2(200 BYTE),
    "KONTAKT_OSOBA" VARCHAR2(100 BYTE)
);

//sekvence i trigeri//
CREATE SEQUENCE  "S19184"."MENADZERSKA_AGENCIJA_PK"
 INCREMENT BY 1 START WITH 1 NOCACHE  NOORDER  NOCYCLE   ;

create or replace TRIGGER "S19184"."MENADZERSKA_AGENCIJA_AUTO_PK"
BEFORE INSERT ON "S19184"."MENADZERSKA_AGENCIJA"
FOR EACH ROW
WHEN (NEW.ID IS NULL)
BEGIN
    SELECT "S19184"."MENADZERSKA_AGENCIJA_PK".NEXTVAL
    INTO :NEW.ID
    FROM DUAL;
END;
// keys i null //

ALTER TABLE MENADZERSKA_AGENCIJA MODIFY ("ID" NOT NULL);
ALTER TABLE MENADZERSKA_AGENCIJA MODIFY ("NAZIV" NOT NULL);
ALTER TABLE MENADZERSKA_AGENCIJA MODIFY ("ADRESA" NOT NULL);
ALTER TABLE MENADZERSKA_AGENCIJA MODIFY ("KONTAKT_OSOBA" NOT NULL);

ALTER TABLE MENADZERSKA_AGENCIJA ADD CONSTRAINT PK_MENADZERSKA_AGENCIJA PRIMARY KEY ("ID");
ALTER TABLE MENADZERSKA_AGENCIJA ADD CONSTRAINT UQ_MENADZERSKA_NAZIV_AG UNIQUE ("NAZIV");
ALTER TABLE MENADZERSKA_AGENCIJA ADD CONSTRAINT UQ_KONTAKT_OSOBA UNIQUE ("KONTAKT_OSOBA");

// constraints //

ALTER TABLE MENADZERSKA_AGENCIJA ADD CONSTRAINT CK_MENADZERSKA_AGENCIJA_NAZIV CHECK (
    LENGTH(TRIM(NAZIV)) > 0 AND
    REGEXP_LIKE(TRIM(NAZIV), '^[A-Za-zčćšđžČĆŠĐŽ0-9 .,&#-]+$')
);

ALTER TABLE MENADZERSKA_AGENCIJA ADD CONSTRAINT CK_MENADZESKA_AGENCIJA_ADRESA CHECK (
    LENGTH(TRIM(ADRESA)) > 0 AND
    REGEXP_LIKE(
        TRIM(ADRESA),
        '^([A-ZČĆŠĐŽ][a-zA-ZčćšđžČĆŠĐŽ\.\-]+(\s+[A-ZČĆŠĐŽ][a-zA-ZčćšđžČĆŠĐŽ\.\-]+)*)\s+[0-9]{1,4}[A-Za-z]?(\s*,\s*([A-ZČĆŠĐŽ][a-zA-ZčćšđžČĆŠĐŽ\.\-]+(\s+[A-ZČĆŠĐŽ][a-zA-ZčćšđžČĆŠĐŽ\.\-]+)*))?$'
    )
);

ALTER TABLE MENADZERSKA_AGENCIJA ADD CONSTRAINT CK_M_AGENCIJA_KONTAKT_OSOBA CHECK (
    LENGTH(TRIM(KONTAKT_OSOBA)) > 0 AND
    REGEXP_LIKE(TRIM(KONTAKT_OSOBA), '^[A-Za-zčćšđžČĆŠĐŽ ]+$')
);
