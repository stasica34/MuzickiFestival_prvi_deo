CREATE TABLE POSETILAC
(
    "ID" NUMBER,
    "IME" VARCHAR2(50 BYTE),
    "PREZIME" VARCHAR2(50 BYTE),
    "EMAIL" VARCHAR2(100 BYTE),
    "TELEFON" VARCHAR2(20 BYTE),
    "GRUPA_ID" NUMBER
);

//sekvenca i trigger //

CREATE SEQUENCE POSETILAC_PK START WITH 1 INCREMENT BY 1 NOCACHE;

CREATE OR REPLACE TRIGGER "S19184"."POSETILAC_AUTO_PK"
BEFORE INSERT ON POSETILAC
REFERENCING NEW AS NEW
FOR EACH ROW
BEGIN
    SELECT POSETILAC_PK.NEXTVAL
    INTO :NEW.ID
    FROM DUAL;
END;

//keys i null //

ALTER TABLE POSETILAC MODIFY ("ID" NOT NULL);
ALTER TABLE POSETILAC MODIFY ("IME" NOT NULL);
ALTER TABLE POSETILAC MODIFY ("PREZIME" NOT NULL);
ALTER TABLE POSETILAC MODIFY ("EMAIL" NOT NULL);

ALTER TABLE POSETILAC ADD CONSTRAINT "PK_POSETILAC" PRIMARY KEY ("ID");
ALTER TABLE POSETILAC ADD CONSTRAINT "UK_POSETILAC_EMAIL" UNIQUE ("EMAIL");
ALTER TABLE POSETILAC ADD CONSTRAINT "UK_POSETILAC_TELEFON" UNIQUE ("TELEFON");

ALTER TABLE POSETILAC ADD CONSTRAINT "POSETILAC_FK2" FOREIGN KEY ("GRUPA_ID")
    REFERENCES GRUPA ("ID_GRUPE");

//constraints //

ALTER TABLE POSETILAC ADD CONSTRAINT "CHK_POSETILAC_IME" CHECK (REGEXP_LIKE(IME, '^[A-Za-z ]+$'));
ALTER TABLE POSETILAC ADD CONSTRAINT "CHK_POSETILAC_PREZIME" CHECK (REGEXP_LIKE(PREZIME, '^[A-Za-z ]+$'));
ALTER TABLE POSETILAC ADD CONSTRAINT "CHK_POSETILAC_EMAIL" CHECK (REGEXP_LIKE(EMAIL, '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$'));
ALTER TABLE POSETILAC ADD CONSTRAINT "CHK_POSETILAC_TELEFON" CHECK (REGEXP_LIKE(TELEFON, '^[0-9]{10}$'));

