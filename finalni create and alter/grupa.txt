CREATE TABLE GRUPA
(
    "ID_GRUPE" NUMBER,
    "NAZIV" VARCHAR2(50 BYTE),
    "AGENCIJA_ORGANIZATOR_ID" NUMBER
)

//sekvence i trigeri//

CREATE SEQUENCE GRUPA_PK START WITH 1 INCREMENT BY 1 NOCACHE;

create or replace TRIGGER "S19184"."GRUPA_AUTO_PK"
BEFORE INSERT ON "S19184"."GRUPA"
FOR EACH ROW
WHEN (NEW.ID_GRUPE IS NULL)
BEGIN
    SELECT "S19184"."GRUPA_PK".NEXTVAL
    INTO :NEW.ID_GRUPE
    FROM DUAL;
END;

//keys i null//

ALTER TABLE GRUPA MODIFY ("AGENCIJA_ORGANIZATOR_ID" NOT NULL);
ALTER TABLE GRUPA MODIFY ("NAZIV" NOT NULL);
ALTER TABLE GRUPA MODIFY ("ID_GRUPE" NOT NULL);
ALTER TABLE GRUPA ADD CONSTRAINT "PK_GRUPA" PRIMARY KEY ("ID_GRUPE");
ALTER TABLE GRUPA ADD CONSTRAINT "UQ_GRUPA_NAZIV_AGENCIJA" UNIQUE ("NAZIV", "AGENCIJA_ORGANIZATOR_ID");
ALTER TABLE GRUPA ADD CONSTRAINT "FK_GRUPA_AGENCIJA_ORGANIZATOR" FOREIGN KEY ("AGENCIJA_ORGANIZATOR_ID")
    REFERENCES AGENCIJA_ORGANIZATOR ("ID") ON DELETE CASCADE;

//constraints//

ALTER TABLE GRUPA ADD CONSTRAINT "CHK_GRUPA_NAZIV" CHECK (
    REGEXP_LIKE(TRIM("NAZIV"), '^[A-Za-zčćšđžČĆŠĐŽ0-9 ]+$')
    AND LENGTH(TRIM("NAZIV")) > 0
);